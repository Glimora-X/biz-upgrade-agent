# ğŸš€ æœ¬åœ°è°ƒè¯•å¿«é€Ÿå¯åŠ¨æŒ‡å—

## é—®é¢˜è§£å†³ï¼šJSON è°ƒè¯•æç¤º

**ä½ é‡åˆ°çš„æç¤ºæ˜¯æ­£å¸¸çš„**ï¼Œè¿™æ˜¯å› ä¸º VSCode æ£€æµ‹åˆ° JSON é…ç½®æ–‡ä»¶ã€‚å¯ä»¥ç›´æ¥ç‚¹å‡» **"Don't Show Again"** å¿½ç•¥ï¼Œæˆ–è€…å®‰è£…ä¸€ä¸ª JSON è¯­è¨€æ”¯æŒæ‰©å±•ï¼ˆå¯é€‰ï¼‰ã€‚

---

## ğŸ“¦ æ­¥éª¤ 1: åˆå§‹åŒ–é¡¹ç›®

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir biz-framework-migration-agent
cd biz-framework-migration-agent

# åˆå§‹åŒ– npm
npm init -y

# å®‰è£…å¿…è¦ä¾èµ–
npm install --save @babel/parser @babel/traverse @babel/types

# å®‰è£…å¼€å‘ä¾èµ–
npm install --save-dev \
  @types/node \
  @types/vscode \
  @types/babel__traverse \
  typescript \
  @typescript-eslint/eslint-plugin \
  @typescript-eslint/parser \
  eslint
```

---

## ğŸ“ æ­¥éª¤ 2: åˆ›å»ºé¡¹ç›®ç»“æ„

```bash
# åˆ›å»ºç›®å½•ç»“æ„
mkdir -p src/{analyzers,providers,config,ui,types}
mkdir -p .vscode
mkdir -p .migration

# åˆ›å»ºå¿…è¦æ–‡ä»¶
touch src/extension.ts
touch .vscode/launch.json
touch .vscode/tasks.json
touch tsconfig.json
```

---

## ğŸ“ æ­¥éª¤ 3: å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶

### 3.1 åˆ›å»º `src/extension.ts`

å°†æˆ‘ä¹‹å‰æä¾›çš„ä¸»ä»£ç å¤åˆ¶åˆ°è¿™ä¸ªæ–‡ä»¶

### 3.2 åˆ›å»º `.vscode/launch.json`

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "è¿è¡Œæ‰©å±•",
      "type": "extensionHost",
      "request": "launch",
      "args": ["--extensionDevelopmentPath=${workspaceFolder}"],
      "outFiles": ["${workspaceFolder}/out/**/*.js"],
      "preLaunchTask": "npm: watch",
      "sourceMaps": true
    }
  ]
}
```

### 3.3 åˆ›å»º `.vscode/tasks.json`

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "npm",
      "script": "watch",
      "problemMatcher": "$tsc-watch",
      "isBackground": true,
      "presentation": {
        "reveal": "never"
      },
      "group": {
        "kind": "build",
        "isDefault": true
      }
    }
  ]
}
```

### 3.4 åˆ›å»º `tsconfig.json`

```json
{
  "compilerOptions": {
    "module": "commonjs",
    "target": "ES2020",
    "outDir": "out",
    "lib": ["ES2020"],
    "sourceMap": true,
    "rootDir": "src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "resolveJsonModule": true
  },
  "exclude": ["node_modules", ".vscode-test"]
}
```

### 3.5 æ›´æ–° `package.json`

æ·»åŠ ä»¥ä¸‹å†…å®¹åˆ°ä½ çš„ package.jsonï¼š

```json
{
  "name": "biz-framework-migration-agent",
  "displayName": "Biz Framework Migration Agent",
  "version": "1.0.0",
  "engines": {
    "vscode": "^1.80.0"
  },
  "main": "./out/extension.js",
  "activationEvents": ["onStartupFinished"],
  "contributes": {
    "commands": [
      {
        "command": "bizMigration.showDashboard",
        "title": "æ˜¾ç¤ºè¿ç§»ä»ªè¡¨æ¿"
      },
      {
        "command": "bizMigration.scanProject",
        "title": "æ‰«ææ•´ä¸ªé¡¹ç›®"
      }
    ]
  },
  "scripts": {
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "vscode:prepublish": "npm run compile"
  }
}
```

---

## ğŸ”§ æ­¥éª¤ 4: ç¼–è¯‘é¡¹ç›®

```bash
# ç¼–è¯‘ TypeScript
npm run compile

# æˆ–å¯åŠ¨ç›‘å¬æ¨¡å¼
npm run watch
```

**ç¡®ä¿æ²¡æœ‰ç¼–è¯‘é”™è¯¯ï¼**

---

## ğŸ¯ æ­¥éª¤ 5: å¯åŠ¨è°ƒè¯•

### æ–¹æ³• 1: ä½¿ç”¨å¿«æ·é”®

1. åœ¨ VSCode ä¸­æ‰“å¼€é¡¹ç›®
2. æŒ‰ `F5` é”®
3. ä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªæ–°çš„ VSCode çª—å£ï¼ˆExtension Development Hostï¼‰

### æ–¹æ³• 2: ä½¿ç”¨è°ƒè¯•é¢æ¿

1. ç‚¹å‡»å·¦ä¾§æ´»åŠ¨æ çš„è°ƒè¯•å›¾æ ‡ï¼ˆè™«å­å›¾æ ‡ï¼‰
2. é€‰æ‹© "è¿è¡Œæ‰©å±•"
3. ç‚¹å‡»ç»¿è‰²æ’­æ”¾æŒ‰é’®

---

## âœ… æ­¥éª¤ 6: æµ‹è¯•æ’ä»¶

åœ¨æ–°æ‰“å¼€çš„ Extension Development Host çª—å£ä¸­ï¼š

### 6.1 åˆ›å»ºæµ‹è¯•æ–‡ä»¶

åˆ›å»ºä¸€ä¸ª `test.ts` æ–‡ä»¶ï¼š

```typescript
import { Component } from "biz-framework"; // åº”è¯¥æœ‰è­¦å‘Š

class MyComponent extends Component {
  componentWillMount() {
    // åº”è¯¥æœ‰è­¦å‘Š
    this.getData(); // åº”è¯¥æœ‰è­¦å‘Š
  }
}
```

### 6.2 æµ‹è¯•åŠŸèƒ½

- âœ… åº”è¯¥çœ‹åˆ°çº¢è‰²æ³¢æµªçº¿ï¼ˆé”™è¯¯æ ‡è®°ï¼‰
- âœ… é¼ æ ‡æ‚¬åœåº”è¯¥æ˜¾ç¤ºè¿ç§»æç¤º
- âœ… ç‚¹å‡»ç¯æ³¡å›¾æ ‡åº”è¯¥æœ‰å¿«é€Ÿä¿®å¤é€‰é¡¹

### 6.3 æ‰“å¼€å‘½ä»¤é¢æ¿

- `Ctrl+Shift+P` (Windows/Linux) æˆ– `Cmd+Shift+P` (Mac)
- è¾“å…¥ "Biz Migration"
- åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå‘½ä»¤ï¼š
  - æ˜¾ç¤ºè¿ç§»ä»ªè¡¨æ¿
  - æ‰«ææ•´ä¸ªé¡¹ç›®

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: ç¼–è¯‘é”™è¯¯

```bash
# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
rm -rf out
npm run compile
```

### é—®é¢˜ 2: æ’ä»¶æœªæ¿€æ´»

æ£€æŸ¥ `package.json` çš„ `activationEvents`ï¼š

```json
"activationEvents": [
  "onStartupFinished"
]
```

### é—®é¢˜ 3: çœ‹ä¸åˆ°æç¤º

1. ç¡®ä¿æ–‡ä»¶åç¼€æ˜¯ `.ts` æˆ– `.js`
2. æ£€æŸ¥ Output é¢æ¿çš„ "Extension Host" è¾“å‡º
3. æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—

### é—®é¢˜ 4: Cannot find module '@babel/parser'

```bash
# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹æ—¥å¿—

åœ¨ Extension Development Host çª—å£ï¼š

- `Help` â†’ `Toggle Developer Tools`
- æŸ¥çœ‹ Console æ ‡ç­¾

### 2. æ·»åŠ æ–­ç‚¹

åœ¨ `src/extension.ts` ä¸­æ·»åŠ æ–­ç‚¹ï¼ŒF5 è¿è¡Œæ—¶ä¼šè‡ªåŠ¨åœåœ¨æ–­ç‚¹å¤„

### 3. æŸ¥çœ‹å˜é‡

åœ¨è°ƒè¯•é¢æ¿çš„ "Variables" åŒºåŸŸæŸ¥çœ‹å½“å‰ä½œç”¨åŸŸçš„å˜é‡

### 4. ä½¿ç”¨ console.log

```typescript
console.log("æ’ä»¶å·²æ¿€æ´»ï¼", context);
```

---

## ğŸ“Š éªŒè¯æˆåŠŸæ ‡å¿—

âœ… ç¼–è¯‘æ— é”™è¯¯  
âœ… F5 èƒ½æ‰“å¼€æ–°çª—å£  
âœ… æµ‹è¯•æ–‡ä»¶æ˜¾ç¤ºè­¦å‘Š  
âœ… æ‚¬åœæç¤ºæ­£å¸¸æ˜¾ç¤º  
âœ… å‘½ä»¤é¢æ¿èƒ½æ‰¾åˆ°æ’ä»¶å‘½ä»¤

---

## ğŸ¨ ä¸‹ä¸€æ­¥

1. **æ·»åŠ é…ç½®æ–‡ä»¶**ï¼šåˆ›å»º `.migration/rules.json` æ·»åŠ å…·ä½“è§„åˆ™
2. **è‡ªå®šä¹‰è§„åˆ™**ï¼šåœ¨ `.migration/custom-rules.js` æ·»åŠ å¤æ‚è§„åˆ™
3. **æµ‹è¯•è¦†ç›–**ï¼šç¼–å†™å•å…ƒæµ‹è¯•
4. **å‘å¸ƒæ‰“åŒ…**ï¼šä½¿ç”¨ `vsce package` æ‰“åŒ…ä¸º `.vsix` æ–‡ä»¶

---

## ğŸ’¡ æç¤º

- ä¿®æ”¹ä»£ç åï¼Œåœ¨ Extension Development Host çª—å£æŒ‰ `Ctrl+R` (Windows/Linux) æˆ– `Cmd+R` (Mac) é‡æ–°åŠ è½½æ’ä»¶
- ä½¿ç”¨ `npm run watch` å¯ä»¥è‡ªåŠ¨ç¼–è¯‘ï¼Œæ— éœ€æ‰‹åŠ¨è¿è¡Œ compile
- æ—¥å¿—è¾“å‡ºåˆ° "Output" é¢æ¿çš„ "Extension Host" é¢‘é“

--- ğŸ’¡ ä»£ç åŒæ­¥
æŒ‰ä¸‹é¢æ­¥éª¤åœ¨ app-service ä»“åº“é‡Œè·‘â€œä¸€é”®åŒæ­¥å‡çº§ä»£ç â€ï¼š

1. æ‰“å¼€ä»“åº“
   åœ¨ VS Code/Cursor é‡Œæ‰“å¼€ app-service çš„æ ¹ç›®å½•ï¼ˆä½œä¸ºå·¥ä½œåŒºï¼‰ã€‚
   ç¡®ä¿æœ¬åœ°å·²å®‰è£… Gitã€yarnï¼Œä¸”ä»“åº“æ˜¯å¹²å‡€/å·²æäº¤çŠ¶æ€ã€‚
2. è¿è¡Œ/å®‰è£…æ‰©å±•
   æœ€ç®€å•ï¼šåœ¨æœ¬é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ npm installï¼Œç„¶åæŒ‰ F5 ä»¥ â€œæ‰©å±•å®¿ä¸»â€ å¯åŠ¨è°ƒè¯•ï¼›å®¿ä¸»çª—å£ä¸­å°±èƒ½ç”¨å‘½ä»¤ã€‚
   å¦‚æœä½ å·²æœ‰æ‰“å¥½çš„ .vsixï¼Œä¹Ÿå¯åœ¨ VS Code é‡Œ â€œInstall from VSIXâ€ï¼Œç„¶åç›´æ¥ç”¨å‘½ä»¤ã€‚
3. æ‰§è¡ŒåŒæ­¥å‘½ä»¤
   åœ¨æ‰©å±•å®¿ä¸»çª—å£ï¼ˆæˆ–å®‰è£…åçš„ VS Codeï¼‰æ‰“å¼€ app-service å·¥ä½œåŒºã€‚
   æŒ‰ Cmd/Ctrl+Shift+Pï¼Œè¿è¡Œå‘½ä»¤ï¼šBiz Migration: ä¸€é”®åŒæ­¥å‡çº§ä»£ç ã€‚
   é€‰æ‹©æ¨¡å¼ï¼š
   â€œå¸¸è§„åŒæ­¥ï¼ˆæ— è„šæœ¬/å°è§„æ¨¡æ”¹åŠ¨ï¼‰â€ â†’ å¯¹åº”å‡çº§æŒ‡å—çš„æ–¹æ¡ˆ 1ã€‚
   â€œé‡å»ºåˆ†æ”¯ï¼ˆè„šæœ¬å˜æ›´/ç»“æ„è°ƒæ•´ï¼‰â€ â†’ å¯¹åº”æ–¹æ¡ˆ 2ã€‚
   æŒ‰æç¤ºå¡«å†™åˆ†æ”¯/è¿œç¨‹ï¼ˆé»˜è®¤å€¼å·²æŒ‰å‡çº§æŒ‡å—ç»™å‡ºï¼šplusã€test-220915ã€feat-test-250918ï¼Œç‰¹æ€§åˆ†æ”¯é»˜è®¤ feature/upgrade-æœˆæ—¥ï¼‰ã€‚
   æµç¨‹ä¼šè‡ªåŠ¨æ‰§è¡Œ git/yarn æ­¥éª¤ï¼›é‡åˆ°éœ€è¦äººå·¥å¤„ç†çš„æ­¥éª¤ï¼ˆå†²çªã€æµ‹è¯•ç­‰ï¼‰ä¼šå¼¹å‡º â€œç»§ç»­/å–æ¶ˆâ€ã€‚å¤„ç†å®Œç‚¹ â€œç»§ç»­â€ å³å¯ã€‚
4. æˆåŠŸæ ‡å¿—
   è¿›åº¦é€šçŸ¥å®Œæˆï¼Œè¾“å‡ºé€šé“ â€œBiz Upgrade Syncâ€ ä¸­æ— é”™è¯¯ã€‚
   ä½ çš„ç‰¹æ€§åˆ†æ”¯å·²è¢«æ¨é€ï¼›åŸºçº¿åˆ†æ”¯å·²åˆå¹¶å¹¶æ¨é€ï¼ˆæŒ‰æ‰€é€‰æ¨¡å¼ï¼‰ã€‚ä¹‹åå» plus ä»“åº“åˆ›å»º MR/PRã€‚

---

éœ€è¦å¸®åŠ©ï¼Ÿæ£€æŸ¥ä»¥ä¸‹æ–‡ä»¶æ˜¯å¦æ­£ç¡®ï¼š

- [ ] `package.json` - main å­—æ®µæŒ‡å‘ `./out/extension.js`
- [ ] `tsconfig.json` - outDir è®¾ç½®ä¸º `out`
- [ ] `.vscode/launch.json` - type ä¸º `extensionHost`
- [ ] `src/extension.ts` - å¯¼å‡º `activate` å’Œ `deactivate` å‡½æ•°
