# ä¼˜åŒ–è¯´æ˜ - çŠ¶æ€æ æŒ‰é’®ç”Ÿå‘½å‘¨æœŸç®¡ç†

## ğŸ¯ éœ€æ±‚

çŠ¶æ€æ æŒ‰é’®åœ¨å‡çº§æµç¨‹ç»“æŸæ—¶åº”è¯¥è¢«è‡ªåŠ¨é”€æ¯ï¼Œé¿å…æ®‹ç•™åœ¨ç•Œé¢ä¸Šã€‚

## ğŸ› ä¹‹å‰çš„é—®é¢˜

### é—®é¢˜æè¿°

```typescript
private async waitForContinue(step: SyncStep) {
  // åˆ›å»ºå±€éƒ¨å˜é‡
  const statusBarItem = vscode.window.createStatusBarItem(...);
  statusBarItem.show();
  
  // åªæœ‰åœ¨é€šçŸ¥æŒ‰é’®å›è°ƒä¸­æ‰æ¸…ç†
  vscode.window.showInformationMessage(...).then((choice) => {
    if (choice === 'ç»§ç»­') {
      statusBarItem.dispose();  // â† åªåœ¨è¿™é‡Œæ¸…ç†
    }
  });
}

// ç”¨æˆ·é€šè¿‡å‘½ä»¤ç»§ç»­æ—¶
resolvePending() {
  this.pendingResolve();
  // âŒ æ²¡æœ‰æ¸…ç† statusBarItemï¼ˆæ— æ³•è®¿é—®ï¼‰
}
```

**é—®é¢˜**ï¼š
1. `statusBarItem` æ˜¯å±€éƒ¨å˜é‡ï¼Œåªåœ¨ `waitForContinue` æ–¹æ³•å†…å¯è§
2. ç”¨æˆ·é€šè¿‡å‘½ä»¤é¢æ¿æ‰§è¡Œ"ç»§ç»­å¿«é€Ÿå‡çº§"æ—¶ï¼Œè°ƒç”¨çš„æ˜¯ `resolvePending` æ–¹æ³•
3. `resolvePending` æ— æ³•è®¿é—® `statusBarItem`ï¼Œå¯¼è‡´çŠ¶æ€æ æŒ‰é’®æ— æ³•è¢«æ¸…ç† âŒ
4. æµç¨‹ç»“æŸåï¼ŒçŠ¶æ€æ æŒ‰é’®ä»ç„¶æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Š âŒ

### é—®é¢˜åœºæ™¯

```
ç”¨æˆ·æ“ä½œæµç¨‹ï¼š
1. é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤º"ç‚¹å‡»ç»§ç»­å‡çº§"æŒ‰é’®
2. ç”¨æˆ·è§£å†³å†²çª
3. ç”¨æˆ·é€šè¿‡å‘½ä»¤é¢æ¿æ‰§è¡Œï¼š"Biz Migration: ç»§ç»­å¿«é€Ÿå‡çº§"
4. æµç¨‹ç»§ç»­æ‰§è¡Œ
5. æµç¨‹å®Œæˆ âœ…
6. ä½†æ˜¯çŠ¶æ€æ æŒ‰é’®ä»ç„¶æ˜¾ç¤º âŒ
7. ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œæç¤º"å½“å‰æ²¡æœ‰æš‚åœçš„å‡çº§æµç¨‹"âŒ
```

## âœ… è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒç­–ç•¥ï¼šå°†çŠ¶æ€æ æŒ‰é’®ä¿å­˜ä¸ºç±»æˆå‘˜å˜é‡

```typescript
export class QuickUpgradeManager {
  private output = vscode.window.createOutputChannel('Biz Quick Upgrade');
  private pendingResolve: (() => void) | null = null;
  private pendingReject: ((reason?: any) => void) | null = null;
  private pendingMessage: string | null = null;
  private currentStatusBarItem: vscode.StatusBarItem | null = null;  // â† æ–°å¢
}
```

### ä¿®æ”¹ 1ï¼šä½¿ç”¨æˆå‘˜å˜é‡åˆ›å»ºçŠ¶æ€æ æŒ‰é’®

```typescript
private async waitForContinue(step: SyncStep) {
  // æ¸…ç†æ—§çš„çŠ¶æ€æ æŒ‰é’®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
  }

  // åˆ›å»ºæ–°çš„çŠ¶æ€æ æŒ‰é’®ï¼ˆä½¿ç”¨æˆå‘˜å˜é‡ï¼‰
  this.currentStatusBarItem = vscode.window.createStatusBarItem(
    vscode.StatusBarAlignment.Left,
    999999
  );
  this.currentStatusBarItem.text = '$(debug-pause) ç‚¹å‡»ç»§ç»­å‡çº§';
  this.currentStatusBarItem.backgroundColor = new vscode.ThemeColor('statusBarItem.warningBackground');
  this.currentStatusBarItem.command = 'bizMigration.resumeQuickUpgrade';
  this.currentStatusBarItem.show();

  // é€šçŸ¥æŒ‰é’®å›è°ƒä¸­ä¸å†æ¸…ç†ï¼ˆç»Ÿä¸€ç”± resolvePending/rejectPending æ¸…ç†ï¼‰
  vscode.window.showInformationMessage(...).then((choice) => {
    if (choice === 'ç»§ç»­') {
      this.resolvePending();  // â† ä¸å†ç›´æ¥ dispose
    } else if (choice === 'å–æ¶ˆ') {
      this.rejectPending(new Error('ç”¨æˆ·å–æ¶ˆ'));  // â† ä¸å†ç›´æ¥ dispose
    }
  });
}
```

### ä¿®æ”¹ 2ï¼šåœ¨ resolvePending ä¸­æ¸…ç†

```typescript
resolvePending() {
  if (this.pendingResolve) {
    this.output.appendLine('âœ… ç»§ç»­æ‰§è¡Œå‡çº§æµç¨‹\n');
    this.pendingResolve();
  } else {
    vscode.window.showWarningMessage('å½“å‰æ²¡æœ‰æš‚åœçš„å‡çº§æµç¨‹');
  }
  
  // âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
    this.currentStatusBarItem = null;
  }
  
  this.pendingResolve = null;
  this.pendingReject = null;
  this.pendingMessage = null;
}
```

### ä¿®æ”¹ 3ï¼šåœ¨ rejectPending ä¸­æ¸…ç†

```typescript
rejectPending(reason?: any) {
  if (this.pendingReject) {
    this.output.appendLine('âŒ å‡çº§æµç¨‹å·²å–æ¶ˆ\n');
    this.pendingReject(reason);
  }
  
  // âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
    this.currentStatusBarItem = null;
  }
  
  this.pendingResolve = null;
  this.pendingReject = null;
  this.pendingMessage = null;
}
```

### ä¿®æ”¹ 4ï¼šåœ¨ runSteps çš„ finally å—ä¸­æ¸…ç†

```typescript
private async runSteps(title: string, steps: SyncStep[], cwd: string) {
  try {
    await vscode.window.withProgress(...);
    vscode.window.showInformationMessage(`${title} å·²å®Œæˆï¼`, 'æŸ¥çœ‹è¾“å‡º');
  } catch (error) {
    const message = error instanceof Error ? error.message : String(error);
    await vscode.window.showErrorMessage(`å‡çº§æµç¨‹ä¸­æ–­ï¼š${message}`, 'æŸ¥çœ‹è¾“å‡º', 'é‡è¯•');
    throw error;
  } finally {
    // âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®ï¼ˆæµç¨‹ç»“æŸæ—¶ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼‰
    if (this.currentStatusBarItem) {
      this.currentStatusBarItem.dispose();
      this.currentStatusBarItem = null;
    }
  }
}
```

## ğŸ“Š æ¸…ç†æ—¶æœº

| è§¦å‘æ–¹å¼ | æ¸…ç†ä½ç½® | è¯´æ˜ |
|---------|---------|------|
| ç”¨æˆ·ç‚¹å‡»é€šçŸ¥"ç»§ç»­"æŒ‰é’® | `resolvePending()` | é€šçŸ¥å›è°ƒè°ƒç”¨ `resolvePending` |
| ç”¨æˆ·ç‚¹å‡»çŠ¶æ€æ æŒ‰é’® | `resolvePending()` | çŠ¶æ€æ æŒ‰é’®è§¦å‘å‘½ä»¤ â†’ `resolvePending` |
| ç”¨æˆ·æ‰§è¡Œå‘½ä»¤"ç»§ç»­å¿«é€Ÿå‡çº§" | `resolvePending()` | ç›´æ¥è°ƒç”¨ `resolvePending` |
| ç”¨æˆ·ç‚¹å‡»é€šçŸ¥"å–æ¶ˆ"æŒ‰é’® | `rejectPending()` | é€šçŸ¥å›è°ƒè°ƒç”¨ `rejectPending` |
| æµç¨‹å®Œæˆï¼ˆæˆåŠŸï¼‰ | `runSteps` finally | ä¿é™©æ¸…ç†ï¼Œç¡®ä¿ä¸æ®‹ç•™ |
| æµç¨‹ä¸­æ–­ï¼ˆå¤±è´¥/å–æ¶ˆï¼‰ | `runSteps` finally | ä¿é™©æ¸…ç†ï¼Œç¡®ä¿ä¸æ®‹ç•™ |

## ğŸ¨ ä¿®å¤æ•ˆæœ

### åœºæ™¯ 1ï¼šé€šè¿‡å‘½ä»¤ç»§ç»­

```
ç”¨æˆ·æ“ä½œï¼š
1. é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤º"ç‚¹å‡»ç»§ç»­å‡çº§"æŒ‰é’®
2. ç”¨æˆ·è§£å†³å†²çª
3. Cmd+Shift+P â†’ "Biz Migration: ç»§ç»­å¿«é€Ÿå‡çº§"
   â†“
4. resolvePending() è¢«è°ƒç”¨
   â†“
5. âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
   â†“
6. æµç¨‹ç»§ç»­
   â†“
7. æµç¨‹å®Œæˆï¼ŒçŠ¶æ€æ å¹²å‡€ âœ…
```

### åœºæ™¯ 2ï¼šç‚¹å‡»çŠ¶æ€æ æŒ‰é’®

```
ç”¨æˆ·æ“ä½œï¼š
1. é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤º"ç‚¹å‡»ç»§ç»­å‡çº§"æŒ‰é’®
2. ç”¨æˆ·è§£å†³å†²çª
3. ç‚¹å‡»çŠ¶æ€æ æŒ‰é’®
   â†“
4. è§¦å‘å‘½ä»¤ â†’ resolvePending() è¢«è°ƒç”¨
   â†“
5. âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
   â†“
6. æµç¨‹ç»§ç»­
   â†“
7. æµç¨‹å®Œæˆï¼ŒçŠ¶æ€æ å¹²å‡€ âœ…
```

### åœºæ™¯ 3ï¼šç‚¹å‡»é€šçŸ¥æŒ‰é’®

```
ç”¨æˆ·æ“ä½œï¼š
1. é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤º"ç‚¹å‡»ç»§ç»­å‡çº§"æŒ‰é’®
2. ç”¨æˆ·è§£å†³å†²çª
3. ç‚¹å‡»é€šçŸ¥ä¸­çš„"ç»§ç»­"æŒ‰é’®
   â†“
4. é€šçŸ¥å›è°ƒ â†’ resolvePending() è¢«è°ƒç”¨
   â†“
5. âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
   â†“
6. æµç¨‹ç»§ç»­
   â†“
7. æµç¨‹å®Œæˆï¼ŒçŠ¶æ€æ å¹²å‡€ âœ…
```

### åœºæ™¯ 4ï¼šæµç¨‹å¼‚å¸¸ç»ˆæ­¢

```
æµç¨‹æ‰§è¡Œä¸­ï¼š
1. é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤º"ç‚¹å‡»ç»§ç»­å‡çº§"æŒ‰é’®
2. ç”¨æˆ·ç‚¹å‡»"ç»§ç»­"
3. æ‰§è¡Œåç»­æ­¥éª¤
4. æŸä¸ªæ­¥éª¤å¤±è´¥ï¼ŒæŠ›å‡ºé”™è¯¯
   â†“
5. catch å—æ•è·é”™è¯¯
   â†“
6. finally å—æ‰§è¡Œ
   â†“
7. âœ… æ¸…ç†çŠ¶æ€æ æŒ‰é’®
   â†“
8. æµç¨‹ç»ˆæ­¢ï¼ŒçŠ¶æ€æ å¹²å‡€ âœ…
```

### åœºæ™¯ 5ï¼šå¤šæ¬¡æš‚åœ

```
æµç¨‹æ‰§è¡Œä¸­ï¼š
1. ç¬¬ä¸€æ¬¡æš‚åœï¼ˆåˆå¹¶å†²çªï¼‰
   â†“
   åˆ›å»ºçŠ¶æ€æ æŒ‰é’® A
   â†“
2. ç”¨æˆ·ç‚¹å‡»"ç»§ç»­"
   â†“
   æ¸…ç†çŠ¶æ€æ æŒ‰é’® A âœ…
   â†“
3. ç¬¬äºŒæ¬¡æš‚åœï¼ˆåˆå¹¶å‰ç¡®è®¤ï¼‰
   â†“
   åˆ›å»ºçŠ¶æ€æ æŒ‰é’® Bï¼ˆå…ˆæ¸…ç†æ—§çš„ï¼‰
   â†“
4. ç”¨æˆ·ç‚¹å‡»"ç»§ç»­"
   â†“
   æ¸…ç†çŠ¶æ€æ æŒ‰é’® B âœ…
   â†“
5. æµç¨‹å®Œæˆï¼ŒçŠ¶æ€æ å¹²å‡€ âœ…
```

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### ä¸ºä»€ä¹ˆä½¿ç”¨æˆå‘˜å˜é‡ï¼Ÿ

**é—®é¢˜**ï¼šå±€éƒ¨å˜é‡æ— æ³•è·¨æ–¹æ³•è®¿é—®
```typescript
// âŒ å±€éƒ¨å˜é‡æ–¹æ¡ˆ
private async waitForContinue(step: SyncStep) {
  const statusBarItem = vscode.window.createStatusBarItem(...);
  // statusBarItem åªåœ¨è¿™ä¸ªæ–¹æ³•å†…å¯è§
}

resolvePending() {
  // âŒ æ— æ³•è®¿é—® statusBarItem
}
```

**è§£å†³**ï¼šä½¿ç”¨æˆå‘˜å˜é‡
```typescript
// âœ… æˆå‘˜å˜é‡æ–¹æ¡ˆ
export class QuickUpgradeManager {
  private currentStatusBarItem: vscode.StatusBarItem | null = null;
}

private async waitForContinue(step: SyncStep) {
  this.currentStatusBarItem = vscode.window.createStatusBarItem(...);
  // æ‰€æœ‰æ–¹æ³•éƒ½å¯ä»¥è®¿é—® this.currentStatusBarItem
}

resolvePending() {
  // âœ… å¯ä»¥è®¿é—®å¹¶æ¸…ç†
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
  }
}
```

### ä¸ºä»€ä¹ˆéœ€è¦ finally å—ï¼Ÿ

**ä¿é™©æœºåˆ¶**ï¼šç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½æ¸…ç†çŠ¶æ€æ æŒ‰é’®

```typescript
try {
  // æ­£å¸¸æµç¨‹
  await this.runCommand(step, cwd);
  // å¯èƒ½åœ¨ä»»ä½•åœ°æ–¹æŠ›å‡ºé”™è¯¯
} catch (error) {
  // å¤„ç†é”™è¯¯
  throw error;
} finally {
  // âœ… æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šæ‰§è¡Œ
  // ç¡®ä¿çŠ¶æ€æ æŒ‰é’®è¢«æ¸…ç†
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
    this.currentStatusBarItem = null;
  }
}
```

### ä¸ºä»€ä¹ˆåœ¨åˆ›å»ºå‰å…ˆæ¸…ç†ï¼Ÿ

**é˜²æ­¢æ®‹ç•™**ï¼šå¦‚æœç”±äºæŸç§åŸå› ï¼ˆå¦‚å¼‚å¸¸æµç¨‹ï¼‰å¯¼è‡´æ—§çš„æŒ‰é’®æ²¡æœ‰è¢«æ¸…ç†ï¼Œåˆ›å»ºæ–°æŒ‰é’®å‰å…ˆæ¸…ç†ä¸€æ¬¡

```typescript
private async waitForContinue(step: SyncStep) {
  // âœ… æ¸…ç†æ—§çš„ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
  if (this.currentStatusBarItem) {
    this.currentStatusBarItem.dispose();
  }

  // åˆ›å»ºæ–°çš„
  this.currentStatusBarItem = vscode.window.createStatusBarItem(...);
  this.currentStatusBarItem.show();
}
```

## âœ… ä¼˜åŒ–æ¸…å•

- [x] âœ… æ·»åŠ  `currentStatusBarItem` æˆå‘˜å˜é‡
- [x] âœ… åœ¨ `waitForContinue` ä¸­ä½¿ç”¨æˆå‘˜å˜é‡
- [x] âœ… åœ¨åˆ›å»ºå‰æ¸…ç†æ—§çš„çŠ¶æ€æ æŒ‰é’®
- [x] âœ… åœ¨ `resolvePending` ä¸­æ¸…ç†
- [x] âœ… åœ¨ `rejectPending` ä¸­æ¸…ç†
- [x] âœ… åœ¨ `runSteps` finally å—ä¸­æ¸…ç†
- [x] âœ… ç¼–è¯‘é€šè¿‡
- [x] âœ… ä¼˜åŒ–è¯´æ˜æ–‡æ¡£

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **é‡æ–°åŠ è½½çª—å£**
   ```
   Cmd+Shift+P â†’ Reload Window
   ```

2. **è¿è¡Œå¿«é€Ÿå‡çº§**
   ```
   Cmd+Shift+P â†’ Biz Migration: å¿«é€Ÿå‡çº§ï¼ˆTest/Inte ç¯å¢ƒï¼‰
   ```

3. **æµ‹è¯•é€šè¿‡å‘½ä»¤ç»§ç»­**
   - é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤ºæŒ‰é’®
   - è§£å†³å†²çª
   - `Cmd+Shift+P â†’ Biz Migration: ç»§ç»­å¿«é€Ÿå‡çº§`
   - âœ… çŠ¶æ€æ æŒ‰é’®åº”è¯¥æ¶ˆå¤±
   - âœ… æµç¨‹ç»§ç»­æ‰§è¡Œ

4. **æµ‹è¯•ç‚¹å‡»çŠ¶æ€æ æŒ‰é’®**
   - é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤ºæŒ‰é’®
   - è§£å†³å†²çª
   - ç‚¹å‡»çŠ¶æ€æ æŒ‰é’®
   - âœ… çŠ¶æ€æ æŒ‰é’®åº”è¯¥æ¶ˆå¤±
   - âœ… æµç¨‹ç»§ç»­æ‰§è¡Œ

5. **æµ‹è¯•ç‚¹å‡»é€šçŸ¥æŒ‰é’®**
   - é‡åˆ°å†²çªï¼ŒçŠ¶æ€æ æ˜¾ç¤ºæŒ‰é’®
   - è§£å†³å†²çª
   - ç‚¹å‡»é€šçŸ¥ä¸­çš„"ç»§ç»­"æŒ‰é’®
   - âœ… çŠ¶æ€æ æŒ‰é’®åº”è¯¥æ¶ˆå¤±
   - âœ… æµç¨‹ç»§ç»­æ‰§è¡Œ

6. **æµ‹è¯•æµç¨‹å®Œæˆ**
   - å®Œæ•´æ‰§è¡Œå‡çº§æµç¨‹
   - æµç¨‹å®Œæˆ
   - âœ… çŠ¶æ€æ æŒ‰é’®åº”è¯¥æ¶ˆå¤±
   - âœ… çŠ¶æ€æ å¹²å‡€

7. **æµ‹è¯•æµç¨‹ä¸­æ–­**
   - æ‰§è¡Œå‡çº§æµç¨‹
   - ä¸­é€”å–æ¶ˆæˆ–å¤±è´¥
   - âœ… çŠ¶æ€æ æŒ‰é’®åº”è¯¥æ¶ˆå¤±
   - âœ… çŠ¶æ€æ å¹²å‡€

### é¢„æœŸç»“æœ

```
âœ… é€šè¿‡å‘½ä»¤ç»§ç»­æ—¶ï¼ŒçŠ¶æ€æ æŒ‰é’®æ¶ˆå¤±
âœ… ç‚¹å‡»çŠ¶æ€æ æŒ‰é’®æ—¶ï¼ŒæŒ‰é’®æ¶ˆå¤±
âœ… ç‚¹å‡»é€šçŸ¥æŒ‰é’®æ—¶ï¼ŒçŠ¶æ€æ æŒ‰é’®æ¶ˆå¤±
âœ… æµç¨‹å®Œæˆæ—¶ï¼ŒçŠ¶æ€æ æŒ‰é’®æ¶ˆå¤±
âœ… æµç¨‹ä¸­æ–­æ—¶ï¼ŒçŠ¶æ€æ æŒ‰é’®æ¶ˆå¤±
âœ… å¤šæ¬¡æš‚åœæ—¶ï¼Œæ—§æŒ‰é’®è¢«æ¸…ç†ï¼Œæ–°æŒ‰é’®æ­£å¸¸æ˜¾ç¤º
âœ… çŠ¶æ€æ ä¸ä¼šæ®‹ç•™ä»»ä½•æŒ‰é’®
```

## ğŸ’¡ æœ€ä½³å®è·µ

### UI èµ„æºç®¡ç†åŸåˆ™

1. **åŠæ—¶æ¸…ç†**ï¼šåˆ›å»ºçš„ UI å…ƒç´ ï¼ˆçŠ¶æ€æ æŒ‰é’®ã€çŠ¶æ€æ é¡¹ã€é€šçŸ¥ç­‰ï¼‰åº”åŠæ—¶æ¸…ç†
2. **å¤šå¤„æ¸…ç†**ï¼šåœ¨æ‰€æœ‰å¯èƒ½çš„é€€å‡ºè·¯å¾„ä¸Šéƒ½è¦æ¸…ç†ï¼ˆæ­£å¸¸ç»“æŸã€å¼‚å¸¸é€€å‡ºã€ç”¨æˆ·å–æ¶ˆï¼‰
3. **ä½¿ç”¨ finally**ï¼šå¯¹äºé‡è¦çš„æ¸…ç†æ“ä½œï¼Œä½¿ç”¨ `finally` å—ç¡®ä¿æ‰§è¡Œ
4. **é˜²æ­¢é‡å¤åˆ›å»º**ï¼šåˆ›å»ºæ–°å…ƒç´ å‰å…ˆæ¸…ç†æ—§å…ƒç´ 
5. **ä½¿ç”¨æˆå‘˜å˜é‡**ï¼šéœ€è¦è·¨æ–¹æ³•è®¿é—®çš„èµ„æºåº”è¯¥ä½¿ç”¨æˆå‘˜å˜é‡

### çŠ¶æ€æ æŒ‰é’®ä½¿ç”¨å»ºè®®

```typescript
// âœ… å¥½çš„åšæ³•
class MyManager {
  private statusBar: vscode.StatusBarItem | null = null;
  
  show() {
    // å…ˆæ¸…ç†æ—§çš„
    if (this.statusBar) {
      this.statusBar.dispose();
    }
    
    // åˆ›å»ºæ–°çš„
    this.statusBar = vscode.window.createStatusBarItem(...);
    this.statusBar.show();
  }
  
  hide() {
    if (this.statusBar) {
      this.statusBar.dispose();
      this.statusBar = null;
    }
  }
  
  async doWork() {
    try {
      this.show();
      // å·¥ä½œä»£ç 
    } finally {
      // ç¡®ä¿æ¸…ç†
      this.hide();
    }
  }
}
```

## ğŸ‰ å®Œæˆ

ç°åœ¨ï¼š
- âœ… çŠ¶æ€æ æŒ‰é’®åœ¨æµç¨‹ç»“æŸæ—¶ä¼šè‡ªåŠ¨é”€æ¯
- âœ… æ— è®ºé€šè¿‡å“ªç§æ–¹å¼ç»§ç»­ï¼Œéƒ½ä¼šæ­£ç¡®æ¸…ç†
- âœ… æµç¨‹å¼‚å¸¸ç»ˆæ­¢æ—¶ä¹Ÿä¼šæ¸…ç†
- âœ… ä¸ä¼šåœ¨çŠ¶æ€æ æ®‹ç•™æŒ‰é’®
- âœ… ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼Œç•Œé¢æ›´å¹²å‡€

**è¯·é‡æ–°åŠ è½½çª—å£å¹¶æµ‹è¯•ï¼** ğŸš€

---

*ä¼˜åŒ–æ—¶é—´: 2024-12-19*
*ä¼˜åŒ–å†…å®¹: çŠ¶æ€æ æŒ‰é’®ç”Ÿå‘½å‘¨æœŸç®¡ç†*
*ç›¸å…³æ–¹æ³•: waitForContinue(), resolvePending(), rejectPending(), runSteps()*

